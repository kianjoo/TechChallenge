@using FlightPlanWeb.Models.DTO;
@*@model Dictionary<string, List<FlightPlanDTO>>*@

<form asp-action="SearchFlightPlan">
	<br/>
	<div class="container border p-3">
		<h1 class="text-primary">Search</h1>
		<hr/>

		<div class="row">
			@*<div asp-validation-summary="ModelOnly" class="text-danger"></div>*@
			
			<div class="col-2">
				<label class="control-label pt-2" style="font-size:20px;">Departure</label>
			</div>

			<div class="col-10 pb-3">
				<input name="departureAerodrome" value="@ViewBag.departure" class="form-control" />
			</div>

			<div class="col-2">
				<label class="control-label pt-2" style="font-size:20px;">Arrival</label>
			</div>

			<div class="col-10 pb-3">
				<input name="arrivalAerodrome" value="@ViewBag.arrival" class="form-control" />
			</div>

			<div class="col-5">
				<input type="submit" value="Search" class="btn btn-success form-control" />
			</div>
		</div>
	</div>
</form>

@{
	@if (@ViewBag.routing.Count > 0)
	{
		<p>Result: @ViewBag.routing.Count</p>

		<table class="table">
			<thead>
				<tr>
					<th>Duration(hr)</th>
					<th>Routes</th>
				</tr>
			</thead>
			<tbody>
				@foreach (KeyValuePair<string, List<FlightPlanDTO>> pair in ViewBag.routing)
				{
					<tr>
						<td>
							@{
								string[] parts = @pair.Key.Split(',');
								<p>@parts[0]</p>
							}
						</td>
						<td>
							<table class="table">
								<thead>
									<tr>
										<th>Id</th>
										<th>Aircraft</th>
										<th>Departure</th>
										<th>Departure Time</th>
										<th>Arrival</th>
										<th>Arrival Time</th>
									</tr>
								</thead>
								<tbody>
									@foreach (FlightPlanDTO fp in @pair.Value)
									{
										<tr>
											<td>@fp.id.PadLeft(5,'0')</td>
											<td>@fp.aircraftIdentification</td>
											<td>@fp.departure.departureAerodrome</td>
											<td>@fp.departure.actualTimeOfDeparture.ToString("yyyyMMdd HH:mm:ss")</td>
											<td>@fp.arrival.arrivalAerodrome</td>
											<td>@fp.arrival.actualTimeOfArrival.ToString("yyyyMMdd HH:mm:ss")</td>
										</tr>
									}
								</tbody>
							</table>
						</td>
					</tr>
				}
			</tbody>
		</table>

	}
}
